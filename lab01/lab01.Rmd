---
title: "Lab01"
author: "Nikitina Natalia"
date: '2 октября 2017 г '
output: html_document
---
ЗАДАНИЕ 1.

1. Сгенерируйте 200 случайных значений из стандартного экспоненциального распределения и сохраните в вектор exp.1. Найдите среднее и стандартное отклонение из данных этого вектора.
```{r}
exp.1 <- rexp(200)
mean.1 <- mean(exp.1)
sd.1 <- sd(exp.1)
```

2. Повторите, использовав следующие значения параметра λ: 0.1, 0.5, 5, 10, и сохраните результаты в векторы: exp.0.1, exp.0.5, exp.5, exp.10.
```{r}
exp.0.1 <- rexp(200,0.1)
mean.0.1 <- mean(exp.0.1)
sd.0.1 <- sd(exp.0.1)

exp.0.5 <- rexp(200,0.5)
mean.0.5 <- mean(exp.0.5)
sd.0.5 <- sd(exp.0.5)

exp.5 <- rexp(200,5)
mean.5 <- mean(exp.5)
sd.5 <- sd(exp.5)

exp.10 <- rexp(200,10)
mean.10 <- mean(exp.10)
sd.10 <- sd(exp.10)
```

3. Функция plot() - общая функция для визуализации данных. Функция hist() принимает данные и раскладывает их по корзинам. Чтобы использовать эти функции, нужно для начала передать им данные, которые хотим визуализировать.

4. Используйте функцию hist() для построения гистограммы полученного ранее стандартного распределения.
```{r}
hist(exp.1, prob = TRUE, main = "Гистограмма стандартного экспоненциального распределения", ylab="Плотность распределения")
curve(dexp(x), from = 0, to = 8, add = TRUE, col = "blue")
```

Выводы: вид полученной гистограммы в целом соответствует виду стандартного экспоненциального распределения, для сравнения также выведенному на рисунке, однако для столбцов с наибольшей плотностью распределения отклонения всё же велики. Это может быть связано с малым количестовом случайных значений (наблюдений), использованных для построения гистограммы. При построении гистограммы с большим количеством наблюдений их распределение становится ближе к требуемому.

5. Используйте функцию plot() с тем же самым вектором для построения графика значений в порядке следования.
```{r}
plot(exp.1, xlab="Индекс значения", main="График значений exp.1 в порядке следования")
lines(exp.1)
```

Выводы: на графике видно, что, как и свойственно любому неравномерному распределению, присутствует заметный разброс значений, при этом относительно малые и крупные значения генерируются в случайном порядке. Кроме того, на графике заметен один очевидный выброс.

6. Используйте функцию plot() с любыми двумя полученными ранее векторами, чтобы получить диаграмму рассеяния (scatterplot) этих векторов относительно друг друга.
```{r}
plot(exp.0.5,exp.5,main="Диаграмма рассеяния exp.0.5 и exp.5")
```

Выводы: диаграмма рассеяния показывает, что между рассматриваемыми векторами не наблюдается выраженной связи (нет однозначной линейной зависимости). В случае наличия тесной связи точки расположены близко друг к другу и составляют узкую полосу, в данном же случае точки широко разбросаны по диаграмме. Таким образом, векторы экспоненциальных распределений с различными значениями λ не являются зависимыми друг от друга.

7. Теперь сравним свойства всех наших векторов. Для начала создадим вектор, содержащий средние значения каждого из 5 полученных ранее распределений в порядке их создания. Полученный вектор сохраним в переменную exp.means.
```{r}
exp.means <- c(mean.1,mean.0.1,mean.0.5,mean.5,mean.10)
```

Далее необходимо создать следующие диаграммы рассеяния:

8. Вектор с пятью средними относительно каждого из пяти векторов с различными значениями λ.
```{r}
#Для уравнения размерностей векторов создадим новый вектор, в котором каждый элемент exp.means повторяется 40 раз (всего - 200 элементов)
exp.means.extend <- rep(exp.means,each=40);
pairs(~exp.means.extend+exp.1+exp.0.1+exp.0.5+exp.5+exp.10,main="Матрица рассеяния exp.sd относительно исходных векторов",horInd=1)
```

Выводы: полученные диаграммы показывают, что между вектором средних и векторами распределений с различными λ нет однозначной линейной связи. 

9. Вектор с пятью стандартными отклонениями относительно каждого из пяти векторов с различными значениями λ.
```{r}
exp.sd <- c(sd.1,sd.0.1,sd.0.5,sd.5,sd.10)
#Для уравнения размерностей векторов создадим новый вектор, в котором каждый элемент exp.sd повторяется 40 раз (всего - 200 элементов)
exp.sd.extend <- rep(exp.means,each=40);
pairs(~exp.sd.extend+exp.1+exp.0.1+exp.0.5+exp.5+exp.10,main="Матрица рассеяния exp.sd относительно исходных векторов",horInd=1)
```

Выводы: полученные диаграммы показывают, что между вектором стандартных отклонений и векторами распределений с различными λ нет однозначной линейной связи. Кроме того, вид данных диаграмм полностью совпадает с диаграммами, полученными в предыдцщем пункте, что позволяет предположить однозначную связь между векторами средних и стандартных отклонений.

10. Вектор с пятью средними относительно вектора с пятью стандартными отклонениями.
```{r}
plot(exp.means,exp.sd,main="Диаграмма рассеяния exp.means относительно exp.sd")
lines(exp.means,exp.sd)
```

Выводы: диаграмма показывает, что между вектором средних и вектором стандратных отклонений существует однозначная линейная зависимость (кривая, полученная при соединении точек диаграммы, практически совпадает с аппроксимирующей прямой).

ЗАДАНИЕ 2.

R достаточно производителен, чтобы вычислять относительно большие объёмы данных.

1. Для демонстрации сгенерируйте 1100000 (1 млн. 100 тысяч) чисел из стандартного экспоненциального распределения и сохраните их в вектор huge.exp.1. Получите среднее и стандартное отклонение.
```{r}
huge.exp.1 <- rexp(1100000)
mean.huge.1 <- mean(huge.exp.1)
sd.huge.1 <- sd(huge.exp.1)
```

2. Получите гистограмму huge.exp.1. Она соответствует функции 1 - e:^(-x)? Должна ли?
```{r}
hist(huge.exp.1, prob = TRUE, main = "Гистограмма стандартного экспоненциального распределения", ylab="Плотность распределения")
curve(dexp(x), from = 0, to = 8, add = TRUE, col = "blue")
```

Выводы: гистограмма - это способ представления статистических данных в графическом виде, отображающий распределение отдельных измерений, из чего следует, что в данном случае она должна соответствовать не функции 1 - e:^(-x) (функции распределения), а функции плотности распределения x*e:^(-x).

Вид полученной гистограммы действительно соответствует виду стандартного экспоненциального распределения. Отклонения от требуемого распределения стали значительно меньше по сравнению с гистограммой из предыдущего задания, построенной при N = 200, следовательно при увеличении количества наблюдений (случайных значений) вид полученного распределения действительно приблизился к требуемому. 

3. Получите среднее всех чисел из huge.exp.1 строго больших 1. Для проверки выборки может потребоваться новый вектор.
```{r}
mean.great.1 <- mean(huge.exp.1>1)

#Проверка
check.great.1 <- huge.exp.1>1
mean.check <- mean(check.great.1)
mean.great.1==mean.check
```

4. Получите матрицу huge.exp.1.mat, содержащую 1100 строк и 1000 колонок. Постройте гистограмму, использовав полученную матрицу. Что можно сказать о полученных данных?
```{r}
huge.exp.1.mat<-matrix(huge.exp.1,nrow=1100,ncol=1000)
hist(huge.exp.1.mat, prob = TRUE, main = "Гистограмма стандартного экспоненциального распределения", ylab="Плотность распределения")
curve(dexp(x), from = 0, to = 8, add = TRUE, col = "blue")
```

Выводы: данная гистограмма в точности дублирует гистограмму, полученную в пункте 2) данного задания, из чего можно сделать вывод, что вид гистограммы не зависит от способа представления входных данных (подаются ли они в виде матрицы или вектора).

5. Рассчитайте среднее 137-й колонки из huge.exp.1.mat.
```{r}
mean.huge.mat.1.137 <- colMeans(huge.exp.1.mat)[137]
```

6. Найдите среднее всей 1000 колонок и сохраните их в вектор. Отобразите диаграмму средних значений колонок. Объясните, почему форма диаграммы отличается от виденных ранее.
```{r}
colMeans.huge.mat.1 <- colMeans(huge.exp.1.mat)

#Столбчатая диаграмма
barplot(colMeans.huge.mat.1)

#Гистограмма
hist(colMeans.huge.mat.1, prob = TRUE, main = "Гистограмма средних значений колонок", ylab="Плотность распределения")

#Проверка для гистограммы: отображение нормального распределения
mean.norm <- mean(colMeans.huge.mat.1)
sd.norm <- sd(colMeans.huge.mat.1)
curve(dnorm(x,mean=mean.norm,sd=sd.norm), from = 0.8, to = 1.20, col = "blue",add=TRUE)
```

Выводы: вид полученной диаграммы объясняется тем, что среднее значение экспоненциального распределения равняется 1/λ, а в данном случае λ=1, следовательно среднее значение каждой колонки стремится к 1.

Кроме того, полученная гистограмма (второй рисунок) практически соответствует нормальному распределению, что может быть объяснено при помощи Центральной предельной теоремы. ЦПТ утверждает, что сумма большого количества независимых случайных величин имеет распределение, близкое к нормальному. Так как при нахождении среднего значения по колонкам применяется суммирование всех элементов этих колонок, полученные средние значения удовлетворяют данной теореме и в совокупности образуют вектор нормально распределенных случайных величин.

7. Рассчитайте квадрат каждого значения из huge.exp.1 и найдите среднее и стандартное отклонение полученного вектора квадратов. Объясните отличие от соответствующих показателей вектора huge.exp.1. Вам может помочь формула, по которой R рассчитывает стандартное отклонение: sqrt(sum((x - mean(x))^2) / (n - 1)).
```{r}
huge.exp.1.square <- huge.exp.1^2
mean.huge.square.1 <- mean(huge.exp.1.square)

#Сравнение результатов с huge.exp.1
sd.huge.square.1 <- sd(huge.exp.1.square)
mean.ratio <- mean.huge.square.1/mean.huge.1
sd.ratio <- sd.huge.square.1/sd.huge.1
```

Выводы: среднее значение экспоненциального распределения равняется 1/λ, а в данном случае λ=1. При распределении квадратов исходных значений среднее значение увеличивается практически ровно в два раза. Увеличение среднего можно объяснить тем, что в формуле среднего сумма исходных значений находится в числителе, то есть при увеличении исходных значений возрастает и среднее. Стандартное отклонение тоже увеличивается, причем соотношение стандартных отклонений квадратов исходных значений и самих этих значений уже больше, чем 2. Это связано с тем, что в формуле стандартного отклонения не просто выполняются элементарные арифметические действия с  исходными значениями, но и присутствует возведение в квадрат.

